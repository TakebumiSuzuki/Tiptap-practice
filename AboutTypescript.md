1.  **VS Code 内蔵の TypeScript (Global)**
    *   **役割:** エディタ上での入力補完、リアルタイムのエラー表示（赤線）、定義へのジャンプなどを担当（Language Server として機能）。
    *   **場所:** VS Code のインストールフォルダ内。
    *   **バージョン:** VS Code のアップデートと共に更新される（常に比較的新しい）。

2.  **プロジェクトの TypeScript (Workspace)**
    *   **役割:** コマンドラインで `npm run build` や `npx tsc` を実行した時に、実際にコードを変換（トランスパイル）するために使用。
    *   **場所:** プロジェクトの `node_modules/typescript`。
    *   **バージョン:** `package.json` で指定したバージョン。

上記2つは、別々のエンジンなのでバージョンが異なってしまう可能性がある。この問題は以下の方法で解決できる。


.vscode/settings.jsonに以下の記述を行う。
これにより、VS Code は `node_modules` の中にある TypeScript エンジンを使って IntelliSense（補完やエラー表示）を動かすようになります。これで「エディタの表示」と「実際のビルド結果」が完全に一致します。

{
  // プロジェクト内の typescript の場所を指定
  "typescript.tsdk": "./node_modules/typescript/lib"
}


**「TypeScript エンジン（コンパイラ）は、5つのステップでコードを処理する一連のパイプライン」** であり、**「VS Code はそのパイプラインの途中までの結果をつまみ食いして表示している」** というのが真実です。

この「5つのステップ」を整理すると、全ての謎が解けます。

---

### TypeScript エンジンの処理フロー（5段階）

`.ts` ファイルが `.js` ファイルになるまでの流れです。

#### 1. Scanner（スキャナ / 字句解析）
*   **やること:** ソースコード（ただの文字列）を読み込み、単語（トークン）にバラします。
*   **例:** `const x = 1;` → `[constキーワード]`, `[変数名x]`, `[=]`, `[数値1]`, `[セミコロン]`
*   *VS Code の利用:* シンタックスハイライト（色分け）の一部に使われます。

#### 2. Parser（パーサー / 構文解析）
*   **やること:** バラバラの単語を組み合わせて、**AST（抽象構文木）** という「ツリー構造のデータ」を作ります。
*   **重要:** ここで「コードの構造」が確定します。
*   *VS Code の利用:* 「カッコの閉じ忘れ」などの**構文エラー**はここで見つかります。自動フォーマット機能などもこのツリー情報を使います。

#### 3. Binder（バインダー / 紐付け）
*   **やること:** AST（ツリー）を見ながら、変数のスコープ（有効範囲）を解析し、**Symbol（シンボル）** を作ります。
*   **重要:** 「この `x` は、さっき定義したあの `x` と同じものだ」というつながりを作ります。
*   *VS Code の利用:* **「定義へ移動」**や**「変数の名前変更（リファクタリング）」**は、この情報を使っています。

#### 4. Checker（チェッカー / 型検査）
*   **やること:** 最も重い処理です。AST と Symbol を使って、「型の矛盾がないか」を徹底的に調べます。
*   **重要:** ここで「数値に文字列を足そうとしている」などの論理的なミスを検出します。
*   *VS Code の利用:* **赤線（型エラー）** の表示、**インテリセンス（コード補完）** の候補出しに使われます。

#### 5. Emitter（エミッター / 出力）
*   **やること:** 最後に、AST を元にして `.js` ファイル（と `.d.ts` や `.map`）を書き出します。
*   **ここで行われること:**
    *   型の削除（Type Erasure）
    *   ダウンレベルコンパイル（新しいJS → 古いJSへの変換）
*   *VS Code の利用:* **基本的には使いません。** （※VS Code上で「ビルド」を実行しない限り、ファイル出力は不要なため）

---

### 結論：VS Code と コマンド(`tsc`) の違い

同じエンジン（頭脳）を持っていますが、**「どこまでやるか」** が違います。

*   **コマンドライン (`tsc`) / ビルドツール:**
    *   **Step 1 〜 5 全部** を一気に実行して、最後にファイルを出力して終了します。

*   **VS Code (Language Server):**
    *   **Step 1 〜 4 まで** をリアルタイムに繰り返し実行し、メモリ上で情報を持ち続けます。
    *   ユーザーがキーを打つたびに Step 1〜4 を高速に回して、「エラーの赤線」や「補完候補」を更新しています。
    *   「ファイル出力（Step 5）」は行わないため、エディタは軽快に動きます。

このように、**「巨大なエンジンの機能のうち、編集に必要な『解析パート（1〜4）』だけを常に借りているのが VS Code」** というイメージで間違いありません。